{"expand": "schema,names", "startAt": 0, "maxResults": 15, "total": 4906, "issues": [{"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13155923", "self": "https://issues.apache.org/jira/rest/api/2/issue/13155923", "key": "CASSANDRA-14426", "fields": {"summary": "cassandra-stress throws NPE if insert section isn't specified in user profile", "description": "When user profile file is used, and insert section isn't specified, then cassandra-stress is using default values instead.\r\n\r\nSince support for LWTs was added, absence of the insert section lead to throwing of NullPointerException when generating inserts:\r\n\r\n{noformat}\r\njava.lang.NullPointerException\r\n\tat org.apache.cassandra.stress.StressProfile.getInsert(StressProfile.java:546)\r\n\tat org.apache.cassandra.stress.StressProfile.printSettings(StressProfile.java:126)\r\n\tat org.apache.cassandra.stress.settings.StressSettings.lambda$printSettings$1(StressSettings.java:311)\r\n\tat java.util.LinkedHashMap.forEach(LinkedHashMap.java:684)\r\n\tat org.apache.cassandra.stress.settings.StressSettings.printSettings(StressSettings.java:311)\r\n\tat org.apache.cassandra.stress.Stress.run(Stress.java:108)\r\n\tat org.apache.cassandra.stress.Stress.main(Stress.java:63)\r\n{noformat}\r\n\r\nFix is trivial, and will be provided as PR", "assignee": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=alexott", "name": "alexott", "key": "alexott", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Alex Ott", "active": true, "timeZone": "Europe/Berlin"}, "created": "2018-04-28T18:02:51.000+0000", "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}}}, {"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13155605", "self": "https://issues.apache.org/jira/rest/api/2/issue/13155605", "key": "CASSANDRA-14423", "fields": {"summary": "SSTables stop being compacted", "description": "So seeing a problem in 3.11.0 where SSTables are being lost from the view and not being included in compactions/as candidates for compaction. It seems to get progressively worse until there's only 1-2 SSTables in the view which happen to be the most recent SSTables and thus compactions completely stop for that table.\r\n\r\nThe SSTables seem to still be included in reads, just not compactions.\r\n\r\nThe issue can be fixed by restarting C*, as it will reload all SSTables into the view, but this is only a temporary fix. User defined/major compactions still work - not clear if they include the result back in the view but is not a good work around.\r\n\r\nThis also results in a discrepancy between SSTable count and SSTables in levels for any table using LCS.\r\n{code:java}\r\nKeyspace : xxx\r\nRead Count: 57761088\r\nRead Latency: 0.10527088681224288 ms.\r\nWrite Count: 2513164\r\nWrite Latency: 0.018211106398149903 ms.\r\nPending Flushes: 0\r\nTable: xxx\r\nSSTable count: 10\r\nSSTables in each level: [2, 0, 0, 0, 0, 0, 0, 0, 0]\r\nSpace used (live): 894498746\r\nSpace used (total): 894498746\r\nSpace used by snapshots (total): 0\r\nOff heap memory used (total): 11576197\r\nSSTable Compression Ratio: 0.6956629530569777\r\nNumber of keys (estimate): 3562207\r\nMemtable cell count: 0\r\nMemtable data size: 0\r\nMemtable off heap memory used: 0\r\nMemtable switch count: 87\r\nLocal read count: 57761088\r\nLocal read latency: 0.108 ms\r\nLocal write count: 2513164\r\nLocal write latency: NaN ms\r\nPending flushes: 0\r\nPercent repaired: 86.33\r\nBloom filter false positives: 43\r\nBloom filter false ratio: 0.00000\r\nBloom filter space used: 8046104\r\nBloom filter off heap memory used: 8046024\r\nIndex summary off heap memory used: 3449005\r\nCompression metadata off heap memory used: 81168\r\nCompacted partition minimum bytes: 104\r\nCompacted partition maximum bytes: 5722\r\nCompacted partition mean bytes: 175\r\nAverage live cells per slice (last five minutes): 1.0\r\nMaximum live cells per slice (last five minutes): 1\r\nAverage tombstones per slice (last five minutes): 1.0\r\nMaximum tombstones per slice (last five minutes): 1\r\nDropped Mutations: 0\r\n{code}\r\nAlso for STCS we've confirmed that SSTable count will be different to the number of SSTables reported in the Compaction Bucket's. In the below example there's only 3 SSTables in a single bucket - no more are listed for this table. Compaction thresholds haven't been modified for this table and it's a very basic KV schema.\r\n{code:java}\r\nKeyspace : yyy\r\n    Read Count: 30485\r\n    Read Latency: 0.06708991307200263 ms.\r\n    Write Count: 57044\r\n    Write Latency: 0.02204061776873992 ms.\r\n    Pending Flushes: 0\r\n        Table: yyy\r\n        SSTable count: 19\r\n        Space used (live): 18195482\r\n        Space used (total): 18195482\r\n        Space used by snapshots (total): 0\r\n        Off heap memory used (total): 747376\r\n        SSTable Compression Ratio: 0.7607394576769735\r\n        Number of keys (estimate): 116074\r\n        Memtable cell count: 0\r\n        Memtable data size: 0\r\n        Memtable off heap memory used: 0\r\n        Memtable switch count: 39\r\n        Local read count: 30485\r\n        Local read latency: NaN ms\r\n        Local write count: 57044\r\n        Local write latency: NaN ms\r\n        Pending flushes: 0\r\n        Percent repaired: 79.76\r\n        Bloom filter false positives: 0\r\n        Bloom filter false ratio: 0.00000\r\n        Bloom filter space used: 690912\r\n        Bloom filter off heap memory used: 690760\r\n        Index summary off heap memory used: 54736\r\n        Compression metadata off heap memory used: 1880\r\n        Compacted partition minimum bytes: 73\r\n        Compacted partition maximum bytes: 124\r\n        Compacted partition mean bytes: 96\r\n        Average live cells per slice (last five minutes): NaN\r\n        Maximum live cells per slice (last five minutes): 0\r\n        Average tombstones per slice (last five minutes): NaN\r\n        Maximum tombstones per slice (last five minutes): 0\r\n        Dropped Mutations: 0 \r\n{code}\r\n{code:java}\r\nApr 27 03:10:39 cassandra[9263]: TRACE o.a.c.d.c.SizeTieredCompactionStrategy Compaction buckets are [[BigTableReader(path='/var/lib/cassandra/data/yyy/yyy-5f7a2d60e4a811e6868a8fd39a64fd59/mc-67168-big-Data.db'), BigTableReader(path='/var/lib/cassandra/data/yyy/yyy-5f7a2d60e4a811e6868a8fd39a64fd59/mc-67167-big-Data.db'), BigTableReader(path='/var/lib/cassandra/data/yyy/yyy-5f7a2d60e4a811e6868a8fd39a64fd59/mc-67166-big-Data.db')]]\r\n{code}\r\nAlso for every LCS table we're seeing the following warning being spammed (seems to be in line with anticompaction spam):\r\n{code:java}\r\nApr 26 21:30:09 cassandra[9263]: WARN\u00a0 o.a.c.d.c.LeveledCompactionStrategy Live sstable /var/lib/cassandra/data/xxx/xxx-8c3ef9e0e3fc11e6868a8fd39a64fd59/mc-79024-big-Data.db from level 0 is not on corresponding level in the leveled manifest. This is not a problem per se, but may indicate an orphaned sstable due to a failed compaction not cleaned up properly.{code}\r\nThis is a vnodes cluster with 256 tokens per node, and the only thing that seems like it could be causing issues is anticompactions.\r\n\r\nCASSANDRA-14079 might be related but doesn't quite describe the same issue, and in this case we're using only a single disk for data. Have yet to reproduce but figured worth reporting here first.", "assignee": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=KurtG", "name": "KurtG", "key": "kurtg", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Kurt Greaves", "active": true, "timeZone": "Etc/UTC"}, "created": "2018-04-27T04:05:22.000+0000", "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}}}, {"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13155508", "self": "https://issues.apache.org/jira/rest/api/2/issue/13155508", "key": "CASSANDRA-14422", "fields": {"summary": "Missing dependencies airline and ohc-core-j8 for pom-all", "description": "I found two missing dependencies for pom-all (cassandra-all):\r\n * airline\r\n * ohc-core-j8\r\n\r\n\u00a0\r\n\r\nThis doesn't affect current build scheme because their jars are hardcoded in the lib directory. However, if we depend on\u00a0cassandra-all in our downstream projects to resolve and fetch dependencies (instead of using the official tarball), Cassandra will have problems, e.g. airline is required by nodetool, and it will fail our dtests.\r\n\r\nI will attach the patch shortly", "assignee": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=shichao.an", "name": "shichao.an", "key": "shichao.an", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Shichao An", "active": true, "timeZone": "America/Los_Angeles"}, "created": "2018-04-26T19:01:47.000+0000", "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}}}, {"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13155436", "self": "https://issues.apache.org/jira/rest/api/2/issue/13155436", "key": "CASSANDRA-14420", "fields": {"summary": "dtests not determining C* version correctly", "description": "In the course of CASSANDRA-14134, the means of extracting the C* version under test before starting a cluster became broken. This is necessary in cases where we want to gate values in cassandra.yaml based on version, so a couple of tests are affected. The specifics are that the global {{CASSANDRA_VERSION_FROM_BUILD}} was hardcoded to '4.0' and the ways in which the various tests use it have meant that it was undetected until now.\r\n\r\nAlso, the {{fixture_since}} which we use to implement the {{@since}} annotation is broken when a {{--cassandra-version}} is supplied, rather than {{--cassandra-dir}}, meaning testing against released versions from git isn't working right now.\r\n\r\nTests directly affected:\r\n * {{auth_test.py}} - CASSANDRA-13985 added some gating of yaml props and additional checks on CQL results based on the build version. These failed on 3.11, which is how this issue was uncovered, but they're also broken on 2.2 on builds.apache.org\r\n * {{user_functions_test.py}} - gates setting a yaml property when version < 3.0. Failing on 2.2.\r\n * {{upgrade_tests}} - a number of these use the variable, but I don't think they're actually being run at the moment.\r\n * {{repair_tests/repair_test.py}}, {{replace_address_test.py}} & {{thrift_test}} all use the global, but only to verify that the version is not 3.9. As we're not running CI for that version, no-one noticed.", "assignee": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=beobal", "name": "beobal", "key": "beobal", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=beobal&avatarId=19518", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=beobal&avatarId=19518", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=beobal&avatarId=19518", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=beobal&avatarId=19518"}, "displayName": "Sam Tunnicliffe", "active": true, "timeZone": "Europe/London"}, "created": "2018-04-26T15:20:56.000+0000", "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}}}, {"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13155345", "self": "https://issues.apache.org/jira/rest/api/2/issue/13155345", "key": "CASSANDRA-14419", "fields": {"summary": "Resume compresed hints delivery broken", "description": "We are using Cassandra 3.0.15 and are using compressed hints, but if hint delivery is interrupted resuming hint delivery is failing.\r\n\r\n{code}\r\n\r\n2018-04-04T13:27:48.948+0200 ERROR [HintsDispatcher:14] CassandraDaemon.java:207 Exception in thread Thread[HintsDispatcher:14,1,main]\r\njava.lang.IllegalArgumentException: Unable to seek to position 1789149057 in /var/lib/cassandra/hints/9592c860-1054-4c60-b3b8-faa9adc6d769-1522838912649-1.hints (118259682 bytes) in read-only mode\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at org.apache.cassandra.io.util.RandomAccessReader.seek(RandomAccessReader.java:287) ~[apache-cassandra-clientutil-3.0.15.jar:3.0.15]\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at org.apache.cassandra.hints.HintsReader.seek(HintsReader.java:114) ~[apache-cassandra-3.0.15.jar:3.0.15]\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at org.apache.cassandra.hints.HintsDispatcher.seek(HintsDispatcher.java:83) ~[apache-cassandra-3.0.15.jar:3.0.15]\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at org.apache.cassandra.hints.HintsDispatchExecutor$DispatchHintsTask.deliver(HintsDispatchExecutor.java:263) ~[apache-cassandra-3.0.15.jar:3.0.15]\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at org.apache.cassandra.hints.HintsDispatchExecutor$DispatchHintsTask.dispatch(HintsDispatchExecutor.java:248) ~[apache-cassandra-3.0.15.jar:3.0.15]\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at org.apache.cassandra.hints.HintsDispatchExecutor$DispatchHintsTask.dispatch(HintsDispatchExecutor.java:226) ~[apache-cassandra-3.0.15.jar:3.0.15]\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at org.apache.cassandra.hints.HintsDispatchExecutor$DispatchHintsTask.run(HintsDispatchExecutor.java:205) ~[apache-cassandra-3.0.15.jar:3.0.15]\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_152]\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_152]\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[na:1.8.0_152]\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_152]\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at org.apache.cassandra.concurrent.NamedThreadFactory.lambda$threadLocalDeallocator$0(NamedThreadFactory.java:79) [apache-cassandra-3.0.15.jar:3.0.15]\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at java.lang.Thread.run(Thread.java:748) ~[na:1.8.0_152]\r\n\r\n{code}\r\n\r\n\u00a0I think the problem is similar to CASSANDRA-11960.", "assignee": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=tommy_s", "name": "tommy_s", "key": "tommy_s", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=tommy_s&avatarId=37156", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tommy_s&avatarId=37156", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tommy_s&avatarId=37156", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tommy_s&avatarId=37156"}, "displayName": "Tommy Stendahl", "active": true, "timeZone": "Europe/Stockholm"}, "created": "2018-04-26T09:08:34.000+0000", "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}}}, {"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13155164", "self": "https://issues.apache.org/jira/rest/api/2/issue/13155164", "key": "CASSANDRA-14418", "fields": {"summary": "Cassandra not starting when using enhanced startup scripts in windows", "description": "I am using Apache Cassandra 3.11.2 with my application.\u00a0\r\n\r\nMy application is getting installed under C:/Program Files/My Application/Some Folder/.\r\n\r\nAnd cassandra\u00a0C:/Program Files/My Application/Some Folder/cassandra.\r\n\r\nSo when I am using enhanced startup scripts cassandra not getting up and running and I am getting below error:\r\n\r\n\"Error: Could not find or load main class Files\\My\"\r\n\r\nOne of the solution I got is moving cassandra to another location where location path does not contain spaces. But this is not good way of getting this problem resolved.\r\n\r\nAfter doing detailed analysis of all the scripts I found the solution below:\r\n\r\nInside file cassandra-env.ps1 at line number 380:\r\n\r\nReplace line:\r\n\r\n$env:JVM_OPTS = \"$env:JVM_OPTS -XX:CompileCommandFile=$env:CASSANDRA_CONF\\hotspot_compiler\"\r\n\r\nwith line\r\n\r\n$env:JVM_OPTS = \"$env:JVM_OPTS -XX:CompileCommandFile=\"\"$env:CASSANDRA_CONF\\hotspot_compiler\"\"\"\r\n\r\nFix here is the double quotes added before $env:CASSANDRA_CONF and\u00a0at the end.\r\n\r\nAt other places this case is well handled. But missed at this place.\r\n\r\n\u00a0", "assignee": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=sphirke", "name": "sphirke", "key": "sphirke", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Shyam Phirke", "active": true, "timeZone": "Etc/UTC"}, "created": "2018-04-25T15:45:27.000+0000", "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}}}, {"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13154459", "self": "https://issues.apache.org/jira/rest/api/2/issue/13154459", "key": "CASSANDRA-14412", "fields": {"summary": "Restore automatic snapshot of system keyspace during upgrade", "description": "Since 2.2, the installed version is compared with the version persisted in system.local (if any) at startup. If these versions differ, the system keyspace is snapshotted before proceeding in order to enable a rollback if any other issue prevents startup from completing. Although the method to perform this check & snapshot is still present in {{SystemKeyspace}}, its only callsite was mistakenly removed from {{CassandraDaemon}} in CASSANDRA-12716.", "assignee": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=beobal", "name": "beobal", "key": "beobal", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=beobal&avatarId=19518", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=beobal&avatarId=19518", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=beobal&avatarId=19518", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=beobal&avatarId=19518"}, "displayName": "Sam Tunnicliffe", "active": true, "timeZone": "Europe/London"}, "created": "2018-04-23T11:52:41.000+0000", "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}}}, {"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13154380", "self": "https://issues.apache.org/jira/rest/api/2/issue/13154380", "key": "CASSANDRA-14411", "fields": {"summary": "Use Bounds instead of Range to represent sstable first/last token when checking how to anticompact sstables", "description": "There is currently a chance of missing marking a token as repaired due to the fact that we use Range which are (a, b] to represent first/last token in sstables instead of Bounds which are [a, b].", "assignee": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=krummas", "name": "krummas", "key": "krummas", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Marcus Eriksson", "active": true, "timeZone": "Europe/Berlin"}, "created": "2018-04-23T06:23:26.000+0000", "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}}}, {"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13153507", "self": "https://issues.apache.org/jira/rest/api/2/issue/13153507", "key": "CASSANDRA-14398", "fields": {"summary": "Client TOPOLOGY_CHANGE  messages have wrong port.", "description": "Summary:\r\n\r\nTOPOLOGY_CHANGE events that are recieved by the client(Driver), with C* 4.0 (Trunk). Contain the storage port (7000) rather than the native port (9042). I believe this is due to changes stuck in for CASSANDRA-7544.\u00a0\u00a0\r\n\r\nI was able to track it down to this specific call here.\r\n [https://github.com/apache/cassandra/blob/trunk/src/java/org/apache/cassandra/service/StorageService.java#L1703]\r\n\r\nWe need an accurate port number from this Topology change event, otherwise we won't be able to correlate node up event against the system.peers_v2 table accurately.\r\n\r\nC* version I'm testing against : 4.0.x (trunk)\r\n\r\nSteps to reproduce:\r\n\r\n1. create a single node, cluster, in this case I'm using ccm.\r\n{code:java}\r\nccm create 400-1 --install-dir=/Users/gregbestland/git/cassandra\r\nccm populate -n 1\r\nccm start\r\n{code}\r\n2. Connect the java driver, and check metadata.\r\n see that there is one node with the correct native port (9042).\r\n\r\n3. Add a brand new node:\r\n{code:java}\r\nccm add node2 -i 127.0.0.2\r\nccm\u00a0node2 start\r\n{code}\r\n4. Incoming topology change message to client will have the storage port, rather then the native port in the message.", "assignee": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=aweisberg", "name": "aweisberg", "key": "aweisberg", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=aweisberg&avatarId=22425", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=aweisberg&avatarId=22425", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=aweisberg&avatarId=22425", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=aweisberg&avatarId=22425"}, "displayName": "Ariel Weisberg", "active": true, "timeZone": "America/New_York"}, "created": "2018-04-18T22:00:55.000+0000", "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}}}, {"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13152996", "self": "https://issues.apache.org/jira/rest/api/2/issue/13152996", "key": "CASSANDRA-14389", "fields": {"summary": "Resolve local address binding in 4.0", "description": "CASSANDRA-8457/CASSANDRA-12229 introduced a regression against CASSANDRA-12673. This was discovered with CASSANDRA-14362 and moved here for resolution independent of that ticket.", "assignee": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=djoshi3", "name": "djoshi3", "key": "djoshi3", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10448", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"}, "displayName": "Dinesh Joshi", "active": true, "timeZone": "America/Los_Angeles"}, "created": "2018-04-17T12:52:22.000+0000", "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}}}, {"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13152896", "self": "https://issues.apache.org/jira/rest/api/2/issue/13152896", "key": "CASSANDRA-14388", "fields": {"summary": "Fix setting min/max compaction threshold with LCS", "description": "To be able to actually set max/min_threshold in compaction options we need to remove it from the options map when validating.", "assignee": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=krummas", "name": "krummas", "key": "krummas", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Marcus Eriksson", "active": true, "timeZone": "Europe/Berlin"}, "created": "2018-04-17T05:43:58.000+0000", "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}}}, {"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13152775", "self": "https://issues.apache.org/jira/rest/api/2/issue/13152775", "key": "CASSANDRA-14387", "fields": {"summary": "SSTableReaderTest#testOpeningSSTable fails on macOS", "description": "I ran into an issue with {{SSTableReaderTest#testOpeningSSTable}} test failure on macOS. The reason for failure seems that on macOS, the file modification timestamps are at a second granularity (See: https://stackoverflow.com/questions/18403588/how-to-return-millisecond-information-for-file-access-on-mac-os-x-in-java and https://developer.apple.com/legacy/library/technotes/tn/tn1150.html#HFSPlusDates). The fix is simple - bumping up the sleep time to 1 second instead of 10ms.\r\n\r\n\r\n{noformat}\r\n    [junit] ------------- ---------------- ---------------\r\n    [junit] Testcase: testOpeningSSTable(org.apache.cassandra.io.sstable.SSTableReaderTest):\tFAILED\r\n    [junit] Bloomfilter was not recreated\r\n    [junit] junit.framework.AssertionFailedError: Bloomfilter was not recreated\r\n    [junit] \tat org.apache.cassandra.io.sstable.SSTableReaderTest.testOpeningSSTable(SSTableReaderTest.java:421)\r\n    [junit]\r\n    [junit]\r\n    [junit] Test org.apache.cassandra.io.sstable.SSTableReaderTest FAILED\r\n{noformat}\r\n\r\nRelated issue: CASSANDRA-11163", "assignee": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=djoshi3", "name": "djoshi3", "key": "djoshi3", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10448", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10448", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10448", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10448"}, "displayName": "Dinesh Joshi", "active": true, "timeZone": "America/Los_Angeles"}, "created": "2018-04-16T17:17:54.000+0000", "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}}}, {"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13151647", "self": "https://issues.apache.org/jira/rest/api/2/issue/13151647", "key": "CASSANDRA-14377", "fields": {"summary": "Returning invalid JSON for NaN and Infinity float values", "description": "After inserting special float values like NaN and Infinity into a table:\r\n\r\n{{CREATE TABLE testme (t1 bigint, t2 float, t3 float, PRIMARY KEY (t1));}}\r\n{{INSERT INTO testme (t1, t2, t3) VALUES (7, NaN, Infinity);}}\r\n\r\nand returning them as JSON...\r\n\r\n{{cqlsh:demodb> select json * from testme;}}\r\n{{\u00a0[json]}}\r\n{{--------------------------------------}}\r\n{{\u00a0\\{\"t1\": 7, \"t2\": NaN, \"t3\": Infinity}}}\r\n\r\n\u00a0\r\n\r\n... the result will not be validated (e.g. with [https://jsonlint.com/|https://jsonlint.com/)] ) because neither NaN nor Infinity is a valid JSON value. The consensus seems to be returning JSON's `null` in these cases, based on this article [https://stackoverflow.com/questions/1423081/json-left-out-infinity-and-nan-json-status-in-ecmascript] and other similar ones.", "assignee": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=blerer", "name": "blerer", "key": "blerer", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=blerer&avatarId=20079", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=blerer&avatarId=20079", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=blerer&avatarId=20079", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=blerer&avatarId=20079"}, "displayName": "Benjamin Lerer", "active": true, "timeZone": "Europe/Berlin"}, "created": "2018-04-11T13:11:28.000+0000", "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}}}, {"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13151469", "self": "https://issues.apache.org/jira/rest/api/2/issue/13151469", "key": "CASSANDRA-14374", "fields": {"summary": "Speculative retry parsing breaks on non-english locale", "description": "I was getting the following error when running unit tests on my machine:\r\n{code:none}\r\nError setting schema for test (query was: CREATE TABLE cql_test_keyspace.table_32 (a int, b int, c text, primary key (a, b)))\r\njava.lang.RuntimeException: Error setting schema for test (query was: CREATE TABLE cql_test_keyspace.table_32 (a int, b int, c text, primary key (a, b)))\r\n\tat org.apache.cassandra.cql3.CQLTester.schemaChange(CQLTester.java:819)\r\n\tat org.apache.cassandra.cql3.CQLTester.createTable(CQLTester.java:632)\r\n\tat org.apache.cassandra.cql3.CQLTester.createTable(CQLTester.java:624)\r\n\tat org.apache.cassandra.cql3.validation.operations.DeleteTest.testDeleteWithNonoverlappingRange(DeleteTest.java:663)\r\nCaused by: org.apache.cassandra.exceptions.ConfigurationException: Specified Speculative Retry Policy [99,00p] is not supported\r\n\tat org.apache.cassandra.service.reads.SpeculativeRetryPolicy.fromString(SpeculativeRetryPolicy.java:135)\r\n\tat org.apache.cassandra.schema.SchemaKeyspace.createTableParamsFromRow(SchemaKeyspace.java:1006)\r\n\tat org.apache.cassandra.schema.SchemaKeyspace.fetchTable(SchemaKeyspace.java:981)\r\n\tat org.apache.cassandra.schema.SchemaKeyspace.fetchTables(SchemaKeyspace.java:941)\r\n\tat org.apache.cassandra.schema.SchemaKeyspace.fetchKeyspace(SchemaKeyspace.java:900)\r\n\tat org.apache.cassandra.schema.SchemaKeyspace.fetchKeyspaces(SchemaKeyspace.java:1301)\r\n\tat org.apache.cassandra.schema.Schema.merge(Schema.java:608)\r\n\tat org.apache.cassandra.schema.MigrationManager.announce(MigrationManager.java:425)\r\n\tat org.apache.cassandra.schema.MigrationManager.announceNewTable(MigrationManager.java:239)\r\n\tat org.apache.cassandra.schema.MigrationManager.announceNewTable(MigrationManager.java:224)\r\n\tat org.apache.cassandra.schema.MigrationManager.announceNewTable(MigrationManager.java:204)\r\n\tat org.apache.cassandra.cql3.statements.CreateTableStatement.announceMigration(CreateTableStatement.java:88)\r\n\tat org.apache.cassandra.cql3.statements.SchemaAlteringStatement.executeInternal(SchemaAlteringStatement.java:120)\r\n\tat org.apache.cassandra.cql3.CQLTester.schemaChange(CQLTester.java:814)\r\n{code}\r\nIt turns out that my machine is configured with {{pt_BR}} locale, which uses comma instead of dot for decimal separator, so the speculative retry option parsing introduced by CASSANDRA-14293, which assumed {{en_US}} locale was not working.\r\n\r\nTo reproduce on Linux:\r\n{code:none}\r\nexport LC_CTYPE=pt_BR.UTF-8\r\nant test -Dtest.name=\"DeleteTest\"\r\nant test -Dtest.name=\"SpeculativeRetryParseTest\"\r\n{code}", "assignee": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=pauloricardomg", "name": "pauloricardomg", "key": "pauloricardomg", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Paulo Motta", "active": true, "timeZone": "America/Sao_Paulo"}, "created": "2018-04-10T19:28:47.000+0000", "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}}}, {"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13151197", "self": "https://issues.apache.org/jira/rest/api/2/issue/13151197", "key": "CASSANDRA-14372", "fields": {"summary": "data_file_directories config - update documentation in cassandra.yaml", "description": "If \"data_file_directories\" configuration is enabled with multiple directories, data is partitioned by token range so that data gets distributed evenly. But the current documentation says that \"Cassandra will spread data evenly across them, subject to the granularity of the configured compaction strategy\". Need to update this comment to reflect the correct behavior.", "assignee": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=n.v.harikrishna", "name": "n.v.harikrishna", "key": "n.v.harikrishna", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=n.v.harikrishna&avatarId=35540", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=n.v.harikrishna&avatarId=35540", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=n.v.harikrishna&avatarId=35540", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=n.v.harikrishna&avatarId=35540"}, "displayName": "Venkata Harikrishna Nukala", "active": true, "timeZone": "Etc/UTC"}, "created": "2018-04-09T21:22:23.000+0000", "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}}}]}